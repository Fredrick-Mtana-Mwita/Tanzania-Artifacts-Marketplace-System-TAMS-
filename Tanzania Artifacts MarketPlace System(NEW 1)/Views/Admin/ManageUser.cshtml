@using Tanzania_Artifacts_MarketPlace_System_NEW_1_.Admin.ViewModel
@model List<ManageUserVM>

@{
    ViewData["Title"] = "Manage Users";
}

<!-- Sidebar -->
<div class="sidebar" id="sidebar">
    <div class="sidebar-header text-center py-4 bg-dark text-white">
        <h4>Admin Dashboard</h4>
    </div>
    <ul class="list-unstyled">
        <li><a href="#" class="sidebar-link" onclick="location.href='@Url.Action("ManageUser", "Admin")'"><i class="fa fa-users"></i> Manage Users</a></li>
        <li><a href="#" class="sidebar-link" onclick="location.href='@Url.Action("CreateUser", "Admin")'"><i class="fa fa-user-plus"></i> Create User</a></li>
        <li><a href="#" class="sidebar-link" onclick="location.href='@Url.Action("AdminOrders", "Admin")'"><i class="fa fa-box"></i> Manage Orders</a></li>
    </ul>
</div>

<!-- Main Content -->
<div class="main-content">
    <div class="container mt-4">
        <h2 class="card bg-primary text-white mb-4 fw-bold text-center shadow-lg p-3">Manage Users</h2>

        @if (TempData["Message"] != null)
        {
            <div class="alert alert-success animate__animated animate__fadeIn">@TempData["Message"]</div>
        }

        <table class="table table-bordered table-hover table-responsive-md shadow-lg">
            <thead class="thead-dark">
                <tr>
                    <th>First Name</th>
                    <th>Last Name</th>
                    <th>Email</th>
                    <th>Role</th>
                    <th class="text-center">Actions</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var user in Model)
                {
                    <tr class="animate__animated animate__fadeIn">
                        <td>@user.FirstName</td>
                        <td>@user.LastName</td>
                        <td>@user.Email</td>
                        <td>@user.Role</td>
                        <td class="text-center">
                            <div class="d-flex justify-content-center align-items-center gap-2 flex-wrap">
                                <!-- Update Role Form -->
                                <form asp-action="UpdateUserRole" method="post" class="d-flex align-items-center gap-2">
                                    <input type="hidden" name="id" value="@user.Id" />
                                    <select name="role" class="form-control form-control-sm w-auto">
                                        @foreach (Roles role in Enum.GetValues(typeof(Roles)))
                                        {
                                            <option value="@role" selected="@(user.Role == role)">
                                                @role
                                            </option>
                                        }
                                    </select>
                                    <button type="submit" class="btn btn-sm btn-primary transition-all">Update</button>
                                </form>

                                <!-- Delete User Form -->
                                <form asp-action="DeleteUser" method="post" onsubmit="return confirm('Are you sure you want to delete this user?');" class="ml-2">
                                    <input type="hidden" name="id" value="@user.Id" />
                                    <button type="submit" class="btn btn-sm btn-danger transition-all">Delete</button>
                                </form>
                            </div>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<!-- Sidebar Toggle Button -->
<button class="sidebar-toggle" id="toggleSidebar">
    <span>&#9776;</span>
</button>


<!-- JavaScript for Sidebar Toggle -->
<script>
    document.getElementById('toggleSidebar').addEventListener('click', function() {
        document.getElementById('sidebar').classList.toggle('active');
    });
</script>
